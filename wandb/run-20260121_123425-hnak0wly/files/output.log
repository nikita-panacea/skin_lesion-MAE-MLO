2026-01-21 12:34:26,606 - Main - INFO - Loading datasets...
2026-01-21 12:34:26,618 - Main - INFO - Train samples: 17731
2026-01-21 12:34:26,618 - Main - INFO - Val samples: 3800
2026-01-21 12:34:26,618 - Main - INFO - Test samples: 3800
2026-01-21 12:34:26,618 - Main - INFO - Creating models...
2026-01-21 12:34:30,041 - Main - INFO - Classifier - Total: 37,029,896 (37.03M)
Successfully loaded UNet from /home/ubuntu/Documents/Nikita/GenSeg/unet/unet.pkl
UNet segmentation model loaded and frozen
2026-01-21 12:34:30,450 - Main - INFO -
======================================================================
2026-01-21 12:34:30,450 - Main - INFO - Training Configuration:
2026-01-21 12:34:30,450 - Main - INFO -   Total iterations: 110800
2026-01-21 12:34:30,450 - Main - INFO -   Iterations per epoch: 1108
2026-01-21 12:34:30,450 - Main - INFO -   Validation every: 100 iterations
2026-01-21 12:34:30,450 - Main - INFO -   Total validations: 1108
2026-01-21 12:34:30,450 - Main - INFO - ======================================================================

2026-01-21 12:34:30,450 - Main - INFO - Initializing MLO engine...
[2026-01-21 12:34:30] [INFO] Initializing Multilevel Optimization...

[2026-01-21 12:34:30] [INFO] *** Problem Information ***
[2026-01-21 12:34:30] [INFO] Name: mae
[2026-01-21 12:34:30] [INFO] Uppers: ['classifier']
[2026-01-21 12:34:30] [INFO] Lowers: []
[2026-01-21 12:34:30] [INFO] Paths: []

[2026-01-21 12:34:30] [INFO] *** Problem Information ***
[2026-01-21 12:34:30] [INFO] Name: classifier
[2026-01-21 12:34:30] [INFO] Uppers: ['masking']
[2026-01-21 12:34:30] [INFO] Lowers: ['mae']
[2026-01-21 12:34:30] [INFO] Paths: []

[2026-01-21 12:34:31] [INFO] *** Problem Information ***
[2026-01-21 12:34:31] [INFO] Name: masking
[2026-01-21 12:34:31] [INFO] Uppers: []
[2026-01-21 12:34:31] [INFO] Lowers: ['classifier']
[2026-01-21 12:34:31] [INFO] Paths: [['masking', 'classifier', 'mae', 'masking']]

[2026-01-21 12:34:31] [INFO] Time spent on initialization: 0.712 (s)
2026-01-21 12:34:31,166 - Main - INFO - ======================================================================
2026-01-21 12:34:31,167 - Main - INFO - Starting iteration-wise MLO training...
2026-01-21 12:34:31,167 - Main - INFO - ======================================================================
Traceback (most recent call last):
  File "train_mlo.py", line 600, in <module>
    main()
  File "train_mlo.py", line 582, in main
    engine.run()
  File "/home/ubuntu/anaconda3/envs/convnextv2/lib/python3.8/site-packages/betty/engine.py", line 100, in run
    self.train_step()
  File "/home/ubuntu/anaconda3/envs/convnextv2/lib/python3.8/site-packages/betty/engine.py", line 91, in train_step
    leaf.step(global_step=self.global_step)
  File "/home/ubuntu/anaconda3/envs/convnextv2/lib/python3.8/site-packages/betty/problems/problem.py", line 449, in step
    self.step_normal(global_step=global_step)
  File "/home/ubuntu/anaconda3/envs/convnextv2/lib/python3.8/site-packages/betty/problems/problem.py", line 388, in step_normal
    loss_dict = self.one_step_descent()
  File "/home/ubuntu/anaconda3/envs/convnextv2/lib/python3.8/site-packages/betty/problems/problem.py", line 341, in one_step_descent
    loss, loss_dict = self.get_loss(batch)
  File "/home/ubuntu/anaconda3/envs/convnextv2/lib/python3.8/site-packages/betty/problems/problem.py", line 504, in get_loss
    maybe_loss_dict = self.training_step_exec(batch)
  File "/home/ubuntu/anaconda3/envs/convnextv2/lib/python3.8/site-packages/betty/problems/problem.py", line 332, in training_step_exec
    return self.training_step(batch)
  File "train_mlo.py", line 68, in training_step
    self.masking_model(patch_embeddings, images,
AttributeError: 'Level1_MAEReconstruction' object has no attribute 'masking_model'
