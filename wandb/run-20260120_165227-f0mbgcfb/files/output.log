2026-01-20 16:52:28,709 - Main - INFO - Loading datasets...
2026-01-20 16:52:28,719 - Main - INFO - Train samples: 17731
2026-01-20 16:52:28,719 - Main - INFO - Val samples: 3800
2026-01-20 16:52:28,719 - Main - INFO - Test samples: 3800
2026-01-20 16:52:28,719 - Main - INFO - Creating models...
2026-01-20 16:52:30,392 - Main - INFO - Classifier - Total: 37,029,896 (37.03M)
Successfully loaded UNet from /home/ubuntu/Documents/Nikita/GenSeg/unet/unet.pkl
UNet segmentation model loaded and frozen
2026-01-20 16:52:30,591 - Main - INFO -
======================================================================
2026-01-20 16:52:30,591 - Main - INFO - Training Configuration:
2026-01-20 16:52:30,591 - Main - INFO -   Total iterations: 110800
2026-01-20 16:52:30,591 - Main - INFO -   Iterations per epoch: 1108
2026-01-20 16:52:30,591 - Main - INFO -   Validation every: 100 iterations
2026-01-20 16:52:30,591 - Main - INFO -   Total validations: 1108
2026-01-20 16:52:30,591 - Main - INFO - ======================================================================

2026-01-20 16:52:30,591 - Main - INFO - Initializing MLO engine...
[2026-01-20 16:52:30] [INFO] Initializing Multilevel Optimization...

[2026-01-20 16:52:30] [INFO] *** Problem Information ***
[2026-01-20 16:52:30] [INFO] Name: mae
[2026-01-20 16:52:30] [INFO] Uppers: ['classifier']
[2026-01-20 16:52:30] [INFO] Lowers: []
[2026-01-20 16:52:30] [INFO] Paths: []

[2026-01-20 16:52:30] [INFO] *** Problem Information ***
[2026-01-20 16:52:30] [INFO] Name: classifier
[2026-01-20 16:52:30] [INFO] Uppers: ['masking']
[2026-01-20 16:52:30] [INFO] Lowers: ['mae']
[2026-01-20 16:52:30] [INFO] Paths: []

[2026-01-20 16:52:30] [INFO] *** Problem Information ***
[2026-01-20 16:52:30] [INFO] Name: masking
[2026-01-20 16:52:30] [INFO] Uppers: []
[2026-01-20 16:52:30] [INFO] Lowers: ['classifier']
[2026-01-20 16:52:30] [INFO] Paths: [['masking', 'classifier', 'mae', 'masking']]

[2026-01-20 16:52:30] [INFO] Time spent on initialization: 0.299 (s)
2026-01-20 16:52:30,890 - Main - INFO - ======================================================================
2026-01-20 16:52:30,890 - Main - INFO - Starting iteration-wise MLO training...
2026-01-20 16:52:30,891 - Main - INFO - ======================================================================
Traceback (most recent call last):
  File "train_mlo.py", line 591, in <module>
    main()
  File "train_mlo.py", line 573, in main
    engine.run()
  File "/home/ubuntu/anaconda3/envs/convnextv2/lib/python3.8/site-packages/betty/engine.py", line 100, in run
    self.train_step()
  File "/home/ubuntu/anaconda3/envs/convnextv2/lib/python3.8/site-packages/betty/engine.py", line 91, in train_step
    leaf.step(global_step=self.global_step)
  File "/home/ubuntu/anaconda3/envs/convnextv2/lib/python3.8/site-packages/betty/problems/problem.py", line 449, in step
    self.step_normal(global_step=global_step)
  File "/home/ubuntu/anaconda3/envs/convnextv2/lib/python3.8/site-packages/betty/problems/problem.py", line 388, in step_normal
    loss_dict = self.one_step_descent()
  File "/home/ubuntu/anaconda3/envs/convnextv2/lib/python3.8/site-packages/betty/problems/problem.py", line 337, in one_step_descent
    self.cur_batch = self.get_batch()
  File "/home/ubuntu/anaconda3/envs/convnextv2/lib/python3.8/site-packages/betty/problems/problem.py", line 463, in get_batch
    batch = tuple(
  File "/home/ubuntu/anaconda3/envs/convnextv2/lib/python3.8/site-packages/betty/problems/problem.py", line 464, in <genexpr>
    self.get_batch_single_loader(i) for i in range(len(self.train_data_loader))
  File "/home/ubuntu/anaconda3/envs/convnextv2/lib/python3.8/site-packages/betty/problems/problem.py", line 478, in get_batch_single_loader
    batch = next(data_iterator)
  File "/home/ubuntu/anaconda3/envs/convnextv2/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 517, in __next__
    data = self._next_data()
  File "/home/ubuntu/anaconda3/envs/convnextv2/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1199, in _next_data
    return self._process_data(data)
  File "/home/ubuntu/anaconda3/envs/convnextv2/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1225, in _process_data
    data.reraise()
  File "/home/ubuntu/anaconda3/envs/convnextv2/lib/python3.8/site-packages/torch/_utils.py", line 429, in reraise
    raise self.exc_type(msg)
FileNotFoundError: Caught FileNotFoundError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/home/ubuntu/anaconda3/envs/convnextv2/lib/python3.8/site-packages/torch/utils/data/_utils/worker.py", line 202, in _worker_loop
    data = fetcher.fetch(index)
  File "/home/ubuntu/anaconda3/envs/convnextv2/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 44, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/ubuntu/anaconda3/envs/convnextv2/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 44, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/ubuntu/Documents/Nikita/lesion-classifier-MLO/datasets/isic_dataset.py", line 81, in __getitem__
    image = Image.open(img_path).convert('RGB')
  File "/home/ubuntu/anaconda3/envs/convnextv2/lib/python3.8/site-packages/PIL/Image.py", line 3431, in open
    fp = builtins.open(filename, "rb")
FileNotFoundError: [Errno 2] No such file or directory: '/home/ubuntu/Documents/Nikita/ISIC_2019_dataset/Train_set/images/ISIC_0028227.jpg'
